--부서별 봉급 총합
SELECT DEPARTMENT_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID;

--DEPARTMENT_ID에 들어있는 값과 JOB_ID에 들어있는 값이 모두 같은 행들은 같은 그룹으로 분류가 된다.
SELECT DEPARTMENT_ID, JOB_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID, JOB_ID;

--ROLLUP
SELECT DEPARTMENT_ID, JOB_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY ROLLUP(DEPARTMENT_ID, JOB_ID)
ORDER BY DEPARTMENT_ID;

--ROLLUP 함수는 앞에 작성한 컬럼을 기준으로 소계를 집계하기 때문에
--순서가 달라지면 결과값도 달라진다.
SELECT JOB_ID, DEPARTMENT_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY ROLLUP(JOB_ID, DEPARTMENT_ID)
ORDER BY DEPARTMENT_ID;

--CUBE() 는 각각의 컬럼 별 모든 조합의 소계를 보여주기 때문에
--컬럼순서가 달라져도 조회결과는 달라지지 않는다.
SELECT DEPARTMENT_ID, JOB_ID, SUM(SALARY) 
FROM EMPLOYEES
GROUP BY CUBE(DEPARTMENT_ID, JOB_ID);

--GROUPING SETS() 소그룹의 결과는 안보여주고, 소그룹별 소계만 보여준다.
SELECT DEPARTMENT_ID, JOB_ID, SUM(SALARY) 
FROM EMPLOYEES
GROUP BY GROUPING SETS(DEPARTMENT_ID,JOB_ID);



